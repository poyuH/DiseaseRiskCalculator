{% extends 'layout.html' %}
{% block content %}
{% load static %}
{% load staticfiles %}

<div class="row">
{% if user.is_active %}
    <h1>Hello {{user.email}}</h1> 
{% else %}
    <h1>Hello from the other side</h1>
{% endif %}
</div>

<div class="row">
<div class="col-12 col-md-8">
<form action=".", method="POST">
    {% csrf_token %}
    {{form.as_p}}
    <input type="submit", name='sub'>
</form>
</div>
    <div class="col-md-4">
        <h4>your bmi: {{bmi}}</h4>
        <h4>your 10-year Atherosclerotic 
            Cardiovascular Disease (including cardiac diseases and stroke) 
            risk: {{ascvd_risk}}%</h4>
        <h4>your dm risk: {{dm_risk}}%</h4></div>
</div>
<div class="row">
{% if user.is_active %}
<div class="col">
    <div class="card col-12">
        <div class="card-header">
            <h4> Your previous BMI </h4>
        </div>
        <div class="card-block">
            <canvas id="bmiChart"></canvas>
        </div>
    </div>
    <div class="card col-12">
        <div class="card-header">
            <h4> Your previous Atherosclerotic Cardiovascular Disease Risk </h4>
        </div>
        <div class="card-block">
            <canvas id="ascvdChart"></canvas>
        </div>
    </div>
    <div class="card col-12">
        <div class="card-header">
            <h4> Your previous DM Risk </h4>
        </div>
        <div class="card-block">
            <canvas id="dmChart"></canvas>
        </div>
    </div>
{% endif %}
</div>
<script src="{% static 'js/graph.js' %}"></script>
<!-- Material Design Bootstrap -->
<script>
    var ctxBmi = document.getElementById('bmiChart').getContext('2d');
    var ctxAscvdRisk = document.getElementById('ascvdChart').getContext('2d');
    var ctxDmRisk = document.getElementById('dmChart').getContext('2d');
    var data = {{data | safe}};
    dataBmi = transformData(data, 'bmi');
    dataAscvdRisk = transformData(data, 'ascvd_risk');
    dataDmRisk = transformData(data, 'dm_risk');
    drawLineChart(ctxBmi, dataBmi, "BMI");
    drawLineChart(ctxAscvdRisk, dataAscvdRisk, "Cardiovascular Disease Risk %");
    drawLineChart(ctxDmRisk, dataDmRisk, "DM Risk %");
</script>
{% endblock %}

